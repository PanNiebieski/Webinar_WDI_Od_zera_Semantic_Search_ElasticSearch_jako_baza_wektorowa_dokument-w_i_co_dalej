<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Od zera Semantic Search ElasticSearch jako baza wektorowa dokumentów i co dalej</title>
        <meta charset="utf-8" />
        <meta http-equiv="x-ua-compatible" content="ie=edge" />
        <meta name="viewport" content="width=device-width" />
        <link href="https://fonts.googleapis.com/css?family=Fira+Sans:400,900&amp;subset=latin-ext" rel="stylesheet" />
        <!-- Shower Theme -->
        <link rel="stylesheet" href="vendors/shower-ribbon/styles/screen-16x9.css" />
        <link rel="stylesheet" href="vendors/shower-CezaryWalenciuk/styles/main.css" />
        <!-- Prism.js -->
        <!-- <link rel="stylesheet" href="vendors/prism/prism-my-white.css" />
        <link rel="stylesheet" href="vendors/prism/custom-prism.css" />
        <link rel="stylesheet" href="codegrid-white.css" /> -->
        <link rel="stylesheet" href="vendors/prism/prism-my-dark.css" />
        <link rel="stylesheet" href="vendors/prism/custom-prism.css" />
        <link rel="stylesheet" href="codegrid-dark.css" />
        <meta property="og:type" content="website">
        <meta property="og:title" content="Od zera Semantic Search ElasticSearch jako baza wektorowa dokumentów i co dalej">
        <meta property="og:description" content="Presentation for WDI">
        <meta property="og:url" content="https://panniebieski.github.io/webinary_Serce_Produktywnosc_rycerza_walczacym_z_korpo_smokiem/">
        <meta property="og:site_name" content="Od zera Semantic Search ElasticSearch jako baza wektorowa dokumentów i co dalej">
        <meta property="og:image" content="https://panniebieski.github.io/webinary_Serce_Produktywnosc_rycerza_walczacym_z_korpo_smokiem/forSocialMedia/FacebookImageForMainPage.jpg"><meta property="og:image:width" content="1200">
        <meta property="og:image:height" content="630">
        <meta name="twitter:title" content="Od zera Semantic Search ElasticSearch jako baza wektorowa dokumentów i co dalej">
        <meta name="twitter:description" content="Presentation for WDI">
        <meta name="twitter:image" content="https://panniebieski.github.io/webinary_Serce_Produktywnosc_rycerza_walczacym_z_korpo_smokiem/forSocialMedia/FacebookImageForMainPage.jpg">
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:site" content="@walenciukc">
        <link rel="icon" type="image/png" sizes="16x16" href="https://panniebieski.github.io/webinary_Serce_Produktywnosc_rycerza_walczacym_z_korpo_smokiem/forSocialMedia/icon/icon16x16.png">
        <link rel="apple-touch-icon" href="https://panniebieski.github.io/webinary_Serce_Produktywnosc_rycerza_walczacym_z_korpo_smokiem/forSocialMedia/icon180x180.png">
        <link rel="shortcut icon" href="https://panniebieski.github.io/webinary_Serce_Produktywnosc_rycerza_walczacym_z_korpo_smokiem/forSocialMedia/icon16x16.png">
        <meta name="msapplication-square150x150logo" content="https://panniebieski.github.io/webinary_Serce_Produktywnosc_rycerza_walczacym_z_korpo_smokiem/forSocialMedia/icon180x180.png">
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    </head>
<body class="shower list">

    <header class="caption">
        <h1>Od zera Semantic Search ElasticSearch jako baza wektorowa dokumentów i co dalej</h1>
        <p></p>
    </header>
    <section class="slide front-page">
        <div class="details">
            <!-- 1. Avatar -->
            <span>Cezary Walenciuk</span>
            <!-- 3. Presentation title -->
            <h2 class="bigbig"><strong style="font-size: 35px;  line-height: 1.3;">

                    <span class="titlec1">Od zera Semantic Search </span>
                    <br />
                    <span class="titlec5">ElasticSearch<span>
                    <br />
                    <span class="titlec3">jako baza wektorowa dokumentów i co dalej</span></strong></h2>
            <!-- 5. Contact the speaker -->
            <h2><a href="https://twitter.com/WalenciukC">@walenciukC</a></h2>
        </div>
        <div>
            <!-- 2. Speaker -->
        </div>
        <div class="imag">
            <img src="images/my-avatar.jpg" alt="Speaker">
        </div>
    </section>
  

        <!--

Masz już bazę ElasticSearch i masz tam miliony dokumentów. Wiesz, że ElasticSearch to super rozwiązania do szukania dokumentów na podstawie wyrazów, słów, zdań, synonimów, współrzędnych geograficznych i liczb. Jednak może to za mało w 2024 roku.

Wiesz, że bazę ElasticSearch można przerobić na bazę wektorową i poszybować jak rakieta z szukaniem i analizowaniem treści dokumentów, aby generować odpowiedzi, które zrozumie człowiek.

Jak to zrobić? Jak wygląda architektura takiego rozwiązania? Jak wygląda to w kodzie?
Jak udźwigać ten temat, jeśli nie wiesz nic na temat sztucznej inteligencji i wskakujesz w to od zera?

O tym ci opowiem. Pora wyruszyć w przygodę!


- Omówienie ElasticSearch
- Architektura całego projektu i jak te puzzle się łączą
- Konwertowanie tekstu na wektory używając OpenAI embedding
- Umieszczanie danych do ElasticSearch
- Szukanie informacji w ElasticSearch
- Dodawania filtrów
- Dostawanie odpowiedzi

-->
    
    <!-- <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/1.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section> -->
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/1.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/2.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/3.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/3.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/4.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/5.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/6.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/7.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/8.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/9.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/10.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/11.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/12.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/13.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/14.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/15.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/16.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/17.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/18.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/19.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/20.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/21.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/22.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/23.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/24.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/25.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/26.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/27.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/28.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/29.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/30.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/31.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/32.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/33.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/34.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/35.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/36.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/37.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/38.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/39.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/40.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/41.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/42.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Tworzenie indeksu my_index_demo_vector z polem dense_vector</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 32px;overflow: hidden;  "  class="language-javascript">
                    <code style="line-height: 32px !important;">
                        PUT my_index_demo_vector
                        {
                         "mappings": {
                           "properties": {
                             "title": {
                             "type": "text"
                             },
                             "embedding": {
                             "type": "dense_vector",
                             "dims": 16
                             }
                           }
                         }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Dodanie dokumentu do my_index_demo_vector</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 28px;overflow: hidden;  "  class="language-javascript">
                    <code style="line-height: 28px !important;">
                        POST  my_index_demo_vector/_doc/1
                        {
                         "title": "Polisa ubezpieczeniowa potężnego Franka",
                         "embedding": [0.123, 0.456, 0.789, 0.234, 0.567, 0.890,
                          0.345, 0.678, 0.901, 0.123, 0.456, 0.789, 0.234, 0.567, 0.890, 0.345]
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Zapytanie hybrydowe do ElasticSearch</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 20px;overflow: hidden;  "  class="language-javascript">
                    <code style="line-height: 20px !important;">
                        POST  my_index_demo_vector/_search
                        {
                           "query": {
                                    "script_score": {
                                        "query": {
                                                "match": {
                                                        "title": "polisa ubezpieczeniowa"
                                                }
                                        },
                                        "script": {
                                            "source": "cosineSimilarity(params.queryVector, 'embedding') + 1.0",
                                            "params": {
                                            "queryVector": [0.123, 0.456, 0.789, 0.234, 0.567, 0.890, 0.345,
                                             0.678, 0.901, 0.123, 0.456, 0.789, 0.234, 0.567, 0.890, 0.345]
                                            }
                                        }    
                                    }
                           }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Wynik zapytania</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 22px;overflow: hidden;  "  class="language-javascript">
                    <code style="line-height: 22px !important;">










                        {
                            "took": 1,
                            "timed_out": false,
                            "_shards": {
                              "total": 1,
                              "successful": 1,
                              "skipped": 0,
                              "failed": 0
                            },
                            "hits": {
                              "total": {
                                "value": 1,
                                "relation": "eq"
                              },
                              "max_score": 2,
                              "hits": [
                                {
                                  "_index": "my_index_demo_vector",
                                  "_id": "1",
                                  "_score": 2,
                                  "_source": {
                                    "title": "Polisa ubezpieczeniowa potężnego Franka",
                                    "embedding": [
                                      0.123,
                                      0.456,
                                      0.789,....
                                    ]
                                  }
                                }
                              ]
                            }
                          }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <!-- <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/43.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/44.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/45.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>    
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/46.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section> -->
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/47.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/48.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/49.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/50.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/51.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/52.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>



    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/55.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/56.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/57.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/58.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/59.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/60.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/61.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/62.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/63.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/64.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Sprawdzenie czy mogę odpytać ElasticSearch w Pythonie</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-python">
                    <code style="line-height: 35px !important;">
                        from elasticsearch import Elasticsearch

                        es = Elasticsearch(
                            "http://localhost:9201"
                        )
                        es.ping()
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Odczytanie pliku CSV</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-python">
                    <code style="line-height: 35px !important;">
                        import pandas as pd

                        df = pd.read_csv("products_catalog.csv").loc[:499]
                        df.head()

                        df.fillna("None", inplace=True)
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Dodanie do tabelki kolumny "DescriptionVector"</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-python">
                    <code style="line-height: 22px !important;">
                        from sentence_transformers import SentenceTransformer

                        model = SentenceTransformer('all-mpnet-base-v2')

                        df["DescriptionVector"] = df["Description"].apply(lambda x: model.encode(x))
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Tworzenie indeksu w ElasticSearch</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-python">
                    <code style="line-height: 25px !important;">
                        from indexMapping import indexMapping

                        es.indices.create(index="all_products_demo", mappings=indexMapping)
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Kod struktury indeksu</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-javascript">
                    <code style="line-height: 35px !important;">























                        indexMapping = {
                            "properties":{
                                "ProductID":{
                                    "type":"long"
                                },
                                "ProductName":{
                                    "type":"text"
                                },
                                "ProductBrand":{
                                    "type":"text"
                                },
                                "Gender":{
                                    "type":"text"
                                },
                                "Price (INR)":{
                                    "type":"long"
                                },
                                "NumImages":{
                                    "type":"long"
                                },
                                "Description":{
                                    "type":"text"
                                },
                                "PrimaryColor":{
                                    "type":"text"
                                },
                                "DescriptionVector":{
                                    "type":"dense_vector",
                                    "dims": 768,
                                    "index":True,
                                    "similarity": "l2_norm"
                                }
                        
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Zapisanie rekordów do ElasticSearch</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-python">
                    <code style="line-height: 22px !important;">
                        record_list = df.to_dict("records")

                        for record in record_list:
                            try:
                                es.index(index="all_products_demo", document=record, 
                                    id=record["ProductID"])
                            except Exception as e:
                                print(e)

                        es.count(index="all_products")
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Tworzenie zapytania do ElasticSearch</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 18px;overflow: hidden;  " class="language-python">
                    <code style="line-height: 18px !important;">
                        input_keyword = "Blue Shoes"

                        vector_of_input_keyword = model.encode(input_keyword)
                        
                        query = {
                            "field" : "DescriptionVector",
                            "query_vector" : vector_of_input_keyword,
                            "k" : 2,
                            "num_candidates" : 500, 
                        }

                        #res = es.knn_search(index="all_products_demo", knn=query , source=["ProductName","Description"])
                        #ElasticsearchWarning: The kNN search API has been replaced by the `knn` option in the search API.

                        res2 = es.search(index="all_products_demo",knn=query, source=["ProductName","Description"])
                        res2["hits"]["hits"]
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Odpowiedź z ElasticSearch</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 15px;overflow: hidden;  " class="language-javascript">
                    <code style="line-height: 15px !important;">                                                                              True             32
                        Name: count, dtype: int64
                        ObjectApiResponse({'acknowledged': True, 'shards_acknowledged': True, 'index': 'all_products_demo'})
                        ObjectApiResponse({'count': 468, '_shards': {'total': 1, 'successful': 1, 'skipped': 0, 'failed': 0}})
                        [{'_index': 'all_products_demo',
                          '_id': '10018013',
                          '_score': 0.61429423,
                          '_source': {'ProductName': 'Puma Men Blue Sneakers',
                           'Description': 'A pair of round-toe blue sneakers, has regular styling, lace-up detailTextile upperCushioned footbedTextured and patterned outsoleWarranty: 3 monthsWarranty provided by brand/manufacturer'}},
                         {'_index': 'all_products_demo',
                          '_id': '10018075',
                          '_score': 0.61429423,
                          '_source': {'ProductName': 'Puma Men Blue Sneakers',
                           'Description': 'A pair of round-toe blue sneakers, has regular styling, lace-up detailTextile upperCushioned footbedTextured and patterned outsoleWarranty: 3 monthsWarranty provided by brand/manufacturer'}}]
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Kod wyszukiwarki</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-python">
                    <code style="line-height: 25px !important;">













                        import streamlit as st
                        from elasticsearch import Elasticsearch
                        from sentence_transformers import SentenceTransformer
                        
                        indexName = "all_products_demo"
                        
                        try:
                            es = Elasticsearch(
                            "http://localhost:9201"
                            )
                        except ConnectionError as e:
                            print("Connection Error:", e)
                            
                        if es.ping():
                            print("Succesfully connected to ElasticSearch!!")
                        else:
                            print("Oops!! Can not connect to Elasticsearch!")
                        
                        
                        
                        
                        def search(input_keyword):
                            model = SentenceTransformer('all-mpnet-base-v2')
                            vector_of_input_keyword = model.encode(input_keyword)
                        
                            query = {
                                "field": "DescriptionVector",
                                "query_vector": vector_of_input_keyword,
                                "k": 10,
                                "num_candidates": 500
                            }
                            res = es.knn_search(index="all_products_demo"
                                                , knn=query 
                                                , source=["ProductName","Description"]
                                                )
                            results = res["hits"]["hits"]
                        
                            return results
                        
                        def main():
                            st.title("Search Fashion Products")
                        
                            # Input: User enters search query
                            search_query = st.text_input("Enter your search query")
                        
                            # Button: User triggers the search
                            if st.button("Search"):
                                if search_query:
                                    # Perform the search and get results
                                    results = search(search_query)
                        
                                    # Display search results
                                    st.subheader("Search Results")
                                    for result in results:
                                        with st.container():
                                            if '_source' in result:
                                                try:
                                                    st.header(f"{result['_source']['ProductName']}")
                                                except Exception as e:
                                                    print(e)
                                                
                                                try:
                                                    st.write(f"Description: {result['_source']['Description']}")
                                                except Exception as e:
                                                    print(e)
                                                st.divider()
                        
                                            
                        if __name__ == "__main__":
                            main()
                        
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/65.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <!-- <div class="progress"></div> -->
    <footer class="badge badge-top-left">
        <a href="#" class="fullscreen">Fullscreen</a>
    </footer>

    <script src="vendors/gamepad/gamepad.js"></script>
    <script src="vendors/shower/shower.min.js"></script>
    <script src="vendors/shower-gamepad/shower.gamepad.js"></script>

    <!-- Prism.js -->
    <script src="vendors/prism/prism.js"></script>
    <script src="vendors/prism/custom-prism.js"></script>

</body>

</html>